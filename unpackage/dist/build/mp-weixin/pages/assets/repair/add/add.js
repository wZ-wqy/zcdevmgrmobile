(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/assets/repair/add/add"],{"085e":function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return i}));var i={uToast:function(){return e.e("uview-ui/components/u-toast/u-toast").then(e.bind(null,"2261"))},uForm:function(){return e.e("uview-ui/components/u-form/u-form").then(e.bind(null,"5241"))},uFormItem:function(){return Promise.all([e.e("common/vendor"),e.e("uview-ui/components/u-form-item/u-form-item")]).then(e.bind(null,"6658"))},uCheckboxGroup:function(){return Promise.all([e.e("common/vendor"),e.e("uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(e.bind(null,"33e6"))},uCheckbox:function(){return e.e("uview-ui/components/u-checkbox/u-checkbox").then(e.bind(null,"10e7"))},uInput:function(){return Promise.all([e.e("common/vendor"),e.e("uview-ui/components/u-input/u-input")]).then(e.bind(null,"b093"))},uUpload:function(){return e.e("uview-ui/components/u-upload/u-upload").then(e.bind(null,"532b"))},uEmpty:function(){return e.e("uview-ui/components/u-empty/u-empty").then(e.bind(null,"dea5"))},uIcon:function(){return e.e("uview-ui/components/u-icon/u-icon").then(e.bind(null,"d696"))},uButton:function(){return e.e("uview-ui/components/u-button/u-button").then(e.bind(null,"2a9f"))}},o=function(){var t=this,n=t.$createElement;t._self._c},u=[]},3034:function(t,n,e){"use strict";e.r(n);var i=e("085e"),o=e("7b80");for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);var s,r=e("f0c5"),a=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"9c5031ba",null,!1,i["a"],s);n["default"]=a.exports},"7b80":function(t,n,e){"use strict";e.r(n);var i=e("93d7"),o=e.n(i);for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);n["default"]=o.a},"93d7":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(e("a34a"));function o(t){return t&&t.__esModule?t:{default:t}}function u(t,n,e,i,o,u,s){try{var r=t[u](s),a=r.value}catch(c){return void e(c)}r.done?n(a):Promise.resolve(a).then(i,o)}function s(t){return function(){var n=this,e=arguments;return new Promise((function(i,o){var s=t.apply(n,e);function r(t){u(s,i,o,r,a,"next",t)}function a(t){u(s,i,o,r,a,"throw",t)}r(void 0)}))}}var r={data:function(){return{saveloading:!1,required:!0,disabled:!0,baseURL:this.ghost+"/api/file/fileupload.do",action:this.ghost+"/api/file/fileupload.do",fileList:[],fList:[],dataList:[],sdataList:[],form:{busid:"",mark:"",uuid:"",fixing:!1,finish:!0}}},onLoad:function(t){},onUnload:function(n){t.$off("selectAssetsFun")},onShow:function(n){var e=this;t.$on("selectAssetsFun",(function(t){if(t.data.length>0){e.$refs.uToast.show({title:"已选择数量:"+t.data.length,position:"center",type:"success",icon:!0,url:""}),e.sdataList=t.data;for(var n=0;n<e.sdataList.length;n++){for(var i=!0,o=0;o<e.dataList.length;o++)if(e.dataList[o].id==e.sdataList[n].id){i=!1;break}i&&e.dataList.push(e.sdataList[n])}}}))},methods:{removeitem:function(t){this.dataList.splice(t,1)},search:function(){this.sdataList=[],this.$u.route({url:"/pages/common/searchassets/searchassets",params:{datarange:"repair"}})},checkboxGroupChange:function(){},removepic:function(t,n,e){this.fList.splice(t,1)},beforeUpload:function(t,n){this.beforeAvatarUpload(t,n)},getUuid:function(){var t,n,e=32,i=16,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),u=[];if(i=i||o.length,e)for(t=0;t<e;t++)u[t]=o[0|Math.random()*i];else for(u[8]=u[13]=u[18]=u[23]="-",u[14]="4",t=0;t<36;t++)u[t]||(n=0|16*Math.random(),u[t]=o[19==t?3&n|8:n]);return u.join("")},beforeAvatarUpload:function(n,e){var i=this,o={},u=this,s=this.getUuid();t.uploadFile({url:this.baseURL+"?uuid="+s+"&bus=file&interval=10000",filePath:e[n].url,name:"file[0]",formData:{param:JSON.stringify(o)},success:function(t){u.fList.push(s)},fail:function(t){i.$refs.uToast.show({title:"上传图片失败",position:"center",type:"error",icon:!0,url:""})}})},normalchange:function(t,n){"fixing"==t&&(this.form.finish=!n),"finish"==t&&(this.form.fixing=!n)},clear:function(){},save:function(){var n=this,e=this.form;if(this.form.finish?e.fstatus="finish":e.fstatus="underrepair",this.$u.test.isEmpty(this.form.freason))this.$refs.uToast.show({title:"请输入报修原因",position:"center",type:"error",icon:!0,url:""});else if(0!=this.dataList.length){e.items=JSON.stringify(this.dataList);var i="";if(this.fList.length>0)for(var o=0;o<this.fList.length;o++)i=i+"#"+this.fList[o];e.files=i,this.saveloading=!0,this.$u.post("/api/zc/resRepair/ext/insertOrUpdate.do",e).then((function(e){n.saveloading=!1,e.success?(n.$refs.uToast.show({title:"报修成功",position:"center",type:"success",icon:!0,url:""}),t.navigateBack({delta:1,success:function(){getCurrentPages().pop()}})):n.$refs.uToast.show({title:e.message,position:"center",type:"error",icon:!0,url:""})}))}else this.$refs.uToast.show({title:"请选择报修的资产",position:"center",type:"error",icon:!0,url:""})},scan:function(){var n=this;return s(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.scanCode({success:function(t){n.form.uuid=t.result},fail:function(n){t.getSetting({success:function(n){var e=n.authSetting["scope.camera"];e||t.showModal({title:"授权失败",content:"需要使用您的相机，请在设置界面打开相关权限",success:function(n){n.confirm&&t.openSetting()}})}})}});case 1:case"end":return e.stop()}}),e)})))()}}};n.default=r}).call(this,e("543d")["default"])},ac0e:function(t,n,e){"use strict";(function(t){e("29fc");i(e("66fd"));var n=i(e("3034"));function i(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["ac0e","common/runtime","common/vendor"]]]);